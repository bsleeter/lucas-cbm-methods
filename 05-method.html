<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>05-method.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="05-method.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="05-method.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.16/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#methods"><span class="toc-section-number">1</span> Methods</a><ul>
<li><a href="#model-structure"><span class="toc-section-number">1.1</span> Model structure</a></li>
<li><a href="#cbm-cfs3-reference-simulations"><span class="toc-section-number">1.2</span> CBM-CFS3 reference simulations</a><ul>
<li><a href="#merchantable-volume-curves"><span class="toc-section-number">1.2.1</span> Merchantable volume curves</a></li>
</ul></li>
<li><a href="#carbon-flow-rates-lucas-flow-pathways-module"><span class="toc-section-number">1.3</span> Carbon flow rates: LUCAS Flow Pathways module</a><ul>
<li><a href="#net-primary-productivity"><span class="toc-section-number">1.3.1</span> Net Primary Productivity</a></li>
<li><a href="#carbon-flux-rates"><span class="toc-section-number">1.3.2</span> Carbon flux rates</a></li>
</ul></li>
<li><a href="#validation"><span class="toc-section-number">1.4</span> Validation</a></li>
<li><a href="#spin-up-of-dom-pools"><span class="toc-section-number">1.5</span> Spin-up of DOM pools</a></li>
<li><a href="#mapping-initial-carbon-stocks"><span class="toc-section-number">1.6</span> Mapping initial carbon stocks</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
## ✓ tibble  3.0.4     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">library</span>(DT)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">library</span>(scales)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">library</span>(plotly)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<div id="methods" class="section level1">
<h1><span class="header-section-number">1</span> Methods</h1>
<p>To estimate carbon stocks and fluxes for CONUS, we linked the CBM-CFS3 spatially referenced model of ecosystem carbon dynamics with the LUCAS spatially explicit model of LULC change. The CBM-CFS3 model was used to generate a set of forest species and ecoregion-level carbon stock and flux rates which were then used within the LUCAS model to produce spatially explicit maps of carbon stocks and fluxes based on LULC change, disturbances, forest ageing, and climate variability.</p>
<div id="model-structure" class="section level2">
<h2><span class="header-section-number">1.1</span> Model structure</h2>
<p>The conterminous U.S (CONUS) was partitioned into a regular grid of 1-km x 1-km cells where each cell was assigned to a discrete land-use/land-cover classes (LULC). The initial land cover map was based on the 2001 National Land Cover Database (NLCD). We further modified the classification system to partition the three NLCD forest classes into forest type-groups based on the U.S. Forest Service classification system. Furthermore, areas classified as shrubland or herbaceous grassland in NLCD were assigned new classes based on the Landfire Existing Vegetation Type (EVT) classification system. In total, the LUCAS STSM contained 61 unique LULC classes (Fig 1).
We modeled transitions between state classes to represent major LULC change processes, including urbanization, agricultural expansion and contraction, forest management (i.e. clear-cut and selection harvest), wildfire, and insect damage. For wildfire and insect damage, we partitioned transition events into low, medium and high severity events. For land use transitions (urbanization, agricultural expansion and contraction), we generated spatial maps of the location of changes based on the NLCD time-series maps for the years 2001, 2006, 2011, and 2016. The 5-year change rates were then annualized, and the model was parameterized to stochastically select cells to transition from one class to another within the 5-year period. For the forest management and disturbance transitions, we used the annual time-series maps from the Landfire Disturbance database to identify areas of change. For disturbance transitions, we assumed that all cells would transition back to their original LULC class in the year following the disturbance event. Forest mortality resulting from drought and/or insects were derived from U.S. Forest Service Aerial Detection Surveys and were modeled the same was as fire and harvest transitions.</p>
<p>We adopted the carbon stock and flux structure of the CBM-CFS3 model for this study. The approach includes the use of five live carbon pools (including above- and belowground pools) and 9 dead organic matter (DOM) pools covering standing dead trees, down deadwood, litter and carbon stored in soils. DOM pools are organized and named based on their rate of decay (e.g. very fast, fast, medium, slow). Carbon transfers between pools followed the same convention as the CBM-CFS3 model with two important modifications. First, rather than using net growth increment, we calculated net primary production (NPP) for each forest type-group and age and used this to drive annual gross carbon accumulation. Second, we introduced annual spatial multipliers to scale NPP based on variations in local climate conditions. These modifications are discussed in more detail below.</p>
</div>
<div id="cbm-cfs3-reference-simulations" class="section level2">
<h2><span class="header-section-number">1.2</span> CBM-CFS3 reference simulations</h2>
<p>We used the CBM-CFS3 model (version 1.2) to generate estimates of carbon stocks across all live and DOM pools for a 1-ha representative stand for each forest type-group. Each forest type-group was assigned to the closest forest type found in the CBM database; when no direct type was available we used generic hardwood or softwood types from CBM-CFS3. Additionally, each species was assigned to a representative ecozone and administrative boundary. We assumed wildfire was the historic stand replacing disturbance type and was the most recent disturbance while using default historic return intervals from CBM-CFS3. No additional disturbances were modeled for the reference simulation. Lastly, we calculated the mean temperature across the range of each forest type-group, using the value to modify the CBM-CFS3 reference simulation.</p>
<div id="merchantable-volume-curves" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Merchantable volume curves</h3>
<p>The CBM-CFS3 model relies on users to provide merchantable volume curves for each tree species modeled. For each forest type-group, parameters used to estimate merchantable volume were queried from the U.S. Forest Service Forest Inventory and Analysis (FIA) database. We used the Von Bertalanffy growth equation to estimate merchantable volume by age as:</p>
<p><span class="math display">\[ y = a*1-exp(-b*age)^3 \]</span></p>
<p>where <em>y</em> is the merchantable volume, <em>a</em> is the asymptote and <em>b</em> is the rate of approach to the asymptote. The resulting estimates of merchantable volume by age (0-300 years), along with default biomass expansion factors from the CBM-CFS3 database, were used as inputs for the reference simulations. The CBM-CFS3 model was then run on an annual timestep for 300 years to estimate the amount of carbon stored in each pool by age by applying species-specific expansion factors to estimate biomass in each tree component. A carbon fraction was applied to estimate the carbon portion of the biomass stock. We used the default biomass expansion factors and carbon proportions from the CBM-CFS3 database.</p>
<div id="htmlwidget-21276a7fbd0b5de0c0b8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-21276a7fbd0b5de0c0b8">{"x":{"filter":"none","data":[["Mixedwood Plains","Atlantic Maritime","Mixedwood Plains","Mixedwood Plains","Montane Cordillera","Pacific Maritime","Montane Cordillera","Pacific Maritime","Montane Cordillera","Montane Cordillera","Pacific Maritime","Montane Cordillera","Pacific Maritime","Montane Cordillera","Montane Cordillera","Montane Cordillera","Mixedwood Plains","Mixedwood Plains","Mixedwood Plains","Mixedwood Plains","Atlantic Maritime","Boreal Shield West","Pacific Maritime","Montane Cordillera","Pacific Maritime","Montane Cordillera","Mixedwood Plains","Mixedwood Plains"],["Ontario","Quebec","Ontario","Ontario","British Columbia","British Columbia","British Columbia","British Columbia","British Columbia","British Columbia","British Columbia","British Columbia","British Columbia","British Columbia","British Columbia","British Columbia","Ontario","Ontario","Ontario","Ontario","Quebec","Ontario","British Columbia","British Columbia","British Columbia","British Columbia","Ontario","Ontario"],["Jack pine","Spruce - Genus type","Pine - Genus type","Pine - Genus type","Other softwoods","Douglas-fir - Genus type","Ponderosa pine","Western white pine","Mountain hemlock","Lodgepole pine","Sitka spruce","Western larch","Other softwoods","Other softwoods","Other softwoods","Other softwoods","Oak","Hickory","Cypress","Ash","Maple","Birch","Alder","Oak","Other hardwoods","Other hardwoods","Other hardwoods","Other hardwoods"],["Forest: White/Red/Jack Pine Group","Forest: Spruce/Fir Group","Forest: Longleaf/Slash Pine Group","Forest: Loblolly/Shortleaf Pine Group","Forest: Pinyon/Juniper Group","Forest: Douglas-fir Group","Forest: Ponderosa Pine Group","Forest: Western White Pine Group","Forest: Fir/Spruce/Mountain Hemlock Group","Forest: Lodgepole Pine Group","Forest: Hemlock/Sitka Spruce Group","Forest: Western Larch Group","Forest: Redwood Group","Forest: Other Western Softwood Group","Forest: California Mixed Conifer Group","Forest: Exotic Softwoods Group","Forest: Oak/Pine Group","Forest: Oak/Hickory Group","Forest: Oak/Gum/Cypress Group","Forest: Elm/Ash/Cottonwood Group","Forest: Maple/Beech/Birch Group","Forest: Aspen/Birch Group","Forest: Alder/Maple Group","Forest: Western Oak Group","Forest: Tanoak/Laurel Group","Forest: Other Western Hardwoods Group","Forest: Tropical Hardwoods Group","Forest: Exotic Hardwoods Group"],[239.99,120.32,148.94,225.7,56.62,597.1,152.73,228.52,241.1,203.42,736.44,298.51,1907.28,138.36,477.09,363.02,191.02,206.02,289.99,155.53,229.04,146.48,436.17,130.24,476.9,130.24,206.48,67.94],[0.04,0.03,0.08,0.08,0.02,0.03,0.03,0.02,0.03,0.03,0.04,0.03,0.01,0.01,0.02,0.03,0.05,0.04,0.03,0.05,0.03,0.04,0.05,0.02,0.04,0.02,0.02,0.09],[6.81,4.64,19.62,17.47,9.74,7.17,7.56,9.75,3.8,3.14,8.38,5.31,12.69,2.47,10.4,7.63,16.8,13.22,18.33,14.23,6.71,5.15,10.47,12.89,13.12,12.81,22.08,19.23],[125,125,125,125,150,300,150,300,150,150,300,150,1000,150,150,150,125,125,125,125,125,75,300,150,300,150,125,125]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>CBM_Ecozone<\/th>\n      <th>CBM_Province<\/th>\n      <th>CBM_Species<\/th>\n      <th>LUCAS_Species<\/th>\n      <th>a<\/th>\n      <th>b<\/th>\n      <th>Temp<\/th>\n      <th>MRI<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[4,5,6,7]}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="carbon-flow-rates-lucas-flow-pathways-module" class="section level2">
<h2><span class="header-section-number">1.3</span> Carbon flow rates: LUCAS Flow Pathways module</h2>
<p>We developed a sub-module within LUCAS to calculate carbon flux parameters based on output from the reference simulations and the CBM-CFS3 database. The module uses the species crosswalk table from above, along with crosswalk tables linking carbon stocks and disturbance types used in LUCAS and CBM-CFS3. Within the LCUAS model we specified a set of carbon Flow Pathways defining all of the carbon pools and fluxes consistent with those used in the CBM-CFS3.</p>
<p>(insert flow diagram here)</p>
<div id="net-primary-productivity" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Net Primary Productivity</h3>
<p>The module first uses results from the CBM-CFS3 reference simulation to calculate net primary productivity (NPP) as the sum of net growth and biomass turnover for a given age:</p>
<p><span class="math display">\[ NPP = \sum_{a} G_{(f,b,s,fr,cr)} + \sum_{a-1} T_{(f,b,s,fr,cr)}\]</span>
where <span class="math inline">\(G\)</span> is net growth, <span class="math inline">\(T\)</span> is biomass turnover, <span class="math inline">\(f\)</span> is foliage, <span class="math inline">\(b\)</span> is branches and other wood, <span class="math inline">\(s\)</span> is merchantable stems, <span class="math inline">\(fr\)</span> if fine roots, <span class="math inline">\(cr\)</span> is coarse roots and <span class="math inline">\(a\)</span> is forest age. Thus, outputs consist of an estimate of NPP by age (up to 300 years old) and are stored as state attributes for each state class type (i.e. forest type-group). Results are stored as a State Attribute within the LUCAS model.</p>
<p>Output from the CBM-CFS3 reference simulation also allows us to calculate the proportional allocation of NPP, by age, between the five live tree component stocks.</p>
<p><span class="math display">\[ pNPP_{s_i}^{a} = \frac{G_{s_i}^{a} + (S_{s_i}^{{a-1}} * T_{s_i})} {NPP^a}  \]</span>
where <span class="math inline">\(pNPP_{s_i}^{a^t}\)</span> is the proportion of NPP allocated to one of five live carbon pools (<span class="math inline">\(s_i\)</span>) for a given aged forest (<span class="math inline">\(a^t\)</span>); <span class="math inline">\(G_{s_i}^{a^t}\)</span> is the net growth of carbon pool <span class="math inline">\(i\)</span> at age <span class="math inline">\(t\)</span>; <span class="math inline">\(S_{s_i}^{a^{t-1}}\)</span> is the amount of carbon stored in pool <span class="math inline">\(i\)</span> at age <span class="math inline">\(t-1\)</span>, <span class="math inline">\(T_{s_i}\)</span> is the species and region specific carbon turnover rate, and <span class="math inline">\(NPP^a\)</span> is the total species and region specific NPP for each forest age. Results are stored as Flow Multipliers within the LUCAS model and used to allocate annual NPP State Attribute values to each live tree component.</p>
</div>
<div id="carbon-flux-rates" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Carbon flux rates</h3>
<p>The LUCAS model uses a set of flow multipliers to estimate carbon fluxes representing biomass turnover, decay and decomposition, emissions, and transfers of carbon resulting from LULC change and disturbance. The LUCAS Flow Pathwyas module uses the set of crosswalk tables described above to parameterize a flow multipliers table for each unique combination of forest type-group and ecozone. Flow multipliers specify the annual rate and proportion of carbon transferred from one stock type to another. The ordering of carbon fluxes within the LUCAS model was established to match that of the CBM-CFS3.</p>
<ol style="list-style-type: decimal">
<li>Transfer of snag stems and branches to down deadwood pools (aboveground medium and fast, respectively),</li>
<li>Emission and decay of standing (snag stems and branches) and down deadwood (aboveground medium),</li>
<li>Emission from the belowground slow pool,</li>
<li>Biomass turnover from live to DOM pools</li>
<li>Emission and decay from DOM pools (belowground very fast, belowground fast, aboveground very fast, aboveground fast)</li>
<li>Emission from aboveground slow</li>
<li>Transfer from aboveground slow to belowground slow</li>
<li>Growth of live pools.</li>
</ol>
<p>In addition to the base carbon flux rates, the LUCAS Flow Pathways module also parameterzies a set of transition-based flow multipliers which control the rate at which carbon is transferred between pools when a change in LULC or disturbance occurs. Transition triggered flows are implemented at the end of each timestep after all base flows have occured. For this study, we considered the effects of fire (high, medium, and low severity), harvest (clearcut and selection), drought/insect mortality, urbanization, agricultural expansion (i.e. deforestation), and agricultural contraction (i.e. reforestation). Flow rates were imported from transition matricies from the CBM-CFS3 model.</p>
</div>
</div>
<div id="validation" class="section level2">
<h2><span class="header-section-number">1.4</span> Validation</h2>
<p>Within the LUCAS model we ran a 300 year simulation with all cells starting at age 0 using the carbon flux rates from the Flow Pathways module to estimate changes in stocks. A single 1-ha representative stand was run for each forest group-type and fire was assumed as the last stand replacing disturbance to match the assumptions from the CBM-CFS3 reference simulations. All stocks were initialized at their age-0 values obtained from the CBM-CFS3 simulations. No disturbances were simulated. We compared individual carbon stock output from the LUCAS simulation with the original output from the CBM-CFS3 reference runs to ensure we could reliably reproduce carbon stock estimates. Figure @ref(fig:validation) shows a comparison of all stock types for the Douglas-fir forest type-group.</p>
<div class="figure">
<img src="05-method_files/figure-html/validation-1.png" alt="Comparison of stock estimates from LUCAS to output from the CBM-CFS3 model." width="768" />
<p class="caption">
(#fig:validation)Comparison of stock estimates from LUCAS to output from the CBM-CFS3 model.
</p>
</div>
</div>
<div id="spin-up-of-dom-pools" class="section level2">
<h2><span class="header-section-number">1.5</span> Spin-up of DOM pools</h2>
<p>The CBM-CFS3 model contains it’s own internal spin-up procedure for stabilizing DOM pools. However, using the CBM-CFS3 method requires running multiple iterations of the model based on the number of types of stand-replacing disturbance events considered in the model. For this reason we developed spin-up module directly with LUCAS. Within LUCAS, carbon stocks are initialized at zero and all cells are set to age zero. The historical stand replacing disturbance type was assumed to be wildfire. Flow pathways and multipliers were used to estimate carbon stocks over a 3000 year simulation period with fire events occurring based on the meanfire return interval specified for each forest type-group. At the end of the 3000 year simulation, two types of stand replacing disturbances were simulated: high sevverity fire and clearcut forest harvest. After each transition, the model was run for another 300 years to generate carbon stocks by age which were used to parameterize a state attribute datafeed in LUCAS. The length of the spin-up simulation can be varied based on how long it takes DOM pools - in particular the belowground slow (soil) pool - to reach a relative steady state between successive historical disturbance events.</p>
<div class="figure">
<img src="05-method_files/figure-html/spinup-1.png" alt="Carbon stock by age for DOM pools for cells initialized with fire or clearcut harvest as the last stand replacing disturbance. Data shown is for the Douglas-fir forest type-group." width="768" />
<p class="caption">
(#fig:spinup)Carbon stock by age for DOM pools for cells initialized with fire or clearcut harvest as the last stand replacing disturbance. Data shown is for the Douglas-fir forest type-group.
</p>
</div>
<p><em>insert figure from spin-up results</em></p>
</div>
<div id="mapping-initial-carbon-stocks" class="section level2">
<h2><span class="header-section-number">1.6</span> Mapping initial carbon stocks</h2>
<p>To estimate spatial carbon stocks the LUCAS model was parameterized with state attribute values from the spin-up procedure described above, flow pathways and multipliers, and raster maps of forest type (i.e. state class type) and and age. The model was run for a single timestep for both wildfire and clearcut harvest as the last disturbance. The combination of forest type and age is used to create initial stock rasters for the first timestep. Fire disturbances prior to 2001 were queried from the National Interagency Fire Consortium (NIFC) and mapped to a 1-km grid. Cells classified in the NIFC map were assigned carbon values from the wildfire simulation; all other cells were assigned stock values from the clearcut harvest simulation.</p>
<p><span class="citation">@kurz2008mountain</span> figured out something.</p>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
